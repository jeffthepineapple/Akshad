<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Akshad’s Soundboard</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">

  <style>
    /* --- RESET & BASE --- */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #f5f5f5;
      color: #333;
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    /* --- HEADER --- */
    #title-container {
      text-align: center;
      margin-bottom: 30px;
      max-width: 600px;
    }
    #title-container h1 {
      font-size: 2.5rem;
      font-weight: 500;
      margin-bottom: 10px;
    }
    #title-container p {
      font-size: 1rem;
      color: #555;
    }

    /* --- SOUNDBOARD GRID --- */
    #soundboard {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 20px;
      width: 100%;
      max-width: 960px;
    }
    .sound-container {
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      padding: 15px;
      text-align: center;
      transition: transform 0.1s;
    }
    .sound-container:hover {
      transform: translateY(-2px);
    }
    .sound-name {
      font-weight: 500;
      margin-bottom: 10px;
      text-transform: capitalize;
      color: #222;
    }

    /* --- BUTTONS --- */
    .controls {
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    .control-button {
      border: none;
      border-radius: 4px;
      padding: 10px 14px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.2s, box-shadow 0.2s;
      color: #fff;
    }
    .control-button:active {
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
    }
    .play-button {
      background-color: #007BFF;
    }
    .play-button:hover {
      background-color: #0056b3;
    }
    .pause-button {
      background-color: #DC3545;
    }
    .pause-button:hover {
      background-color: #a71d2a;
    }
  </style>
</head>
<body>

  <div id="title-container">
    <h1>Akshad’s Soundboard</h1>
    <p>Click a button to play one of Akshad’s curated audio clips. Lazy-loading ensures fast initial load—only fetch what you play.</p>
  </div>

  <div id="soundboard">
    <h2>Loading sound list…</h2>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const soundboard = document.getElementById('soundboard');
      let currentlyPlaying = null;

      const githubUser = 'jeffthepineapple';
      const githubRepo = 'Akshad';
      const soundsDir = 'sounds';
      const mainBranch = 'main';
      const apiUrl = `https://api.github.com/repos/${githubUser}/${githubRepo}/contents/${soundsDir}`;

      fetch(apiUrl)
        .then(res => {
          if (!res.ok) throw new Error(`GitHub API error: ${res.status}`);
          return res.json();
        })
        .then(files => {
          soundboard.innerHTML = '';
          if (!Array.isArray(files) || files.length === 0) {
            soundboard.innerHTML = '<h2>No sounds found.</h2>';
            return;
          }

          files.forEach(file => {
            if (file.type !== 'file' || !file.name.endsWith('.mp3')) return;

            const soundName = file.name.replace(/[-_]/g,' ').replace(/\.mp3$/, '');
            const container = document.createElement('div');
            container.className = 'sound-container';

            const nameLabel = document.createElement('div');
            nameLabel.className = 'sound-name';
            nameLabel.textContent = soundName;

            const controlsDiv = document.createElement('div');
            controlsDiv.className = 'controls';

            const playButton = document.createElement('button');
            playButton.className = 'control-button play-button';
            playButton.textContent = '►';

            const pauseButton = document.createElement('button');
            pauseButton.className = 'control-button pause-button';
            pauseButton.textContent = '⏸';

            controlsDiv.append(playButton, pauseButton);
            container.append(nameLabel, controlsDiv);
            soundboard.appendChild(container);

            // Lazy-loaded audio
            const audioUrl = `https://raw.githubusercontent.com/${githubUser}/${githubRepo}/${mainBranch}/${file.path}`;
            let audio = null;

            playButton.addEventListener('click', () => {
              // pause any other
              if (currentlyPlaying && currentlyPlaying !== audio) {
                currentlyPlaying.pause();
                currentlyPlaying.currentTime = 0;
              }
              // create on first play
              if (!audio) {
                audio = new Audio(audioUrl);
                audio.preload = 'none';
                audio.addEventListener('ended', () => {
                  audio.currentTime = 0;
                  currentlyPlaying = null;
                });
                audio.addEventListener('error', () => {
                  console.error(`Error loading ${file.name}`, audio.error);
                });
              }
              audio.play();
              currentlyPlaying = audio;
            });

            pauseButton.addEventListener('click', () => {
              if (audio) {
                audio.pause();
                currentlyPlaying = null;
              }
            });
          });
        })
        .catch(err => {
          soundboard.innerHTML = '<h2>Error fetching sounds.</h2>';
          console.error(err);
        });
    });
  </script>
</body>
</html>
